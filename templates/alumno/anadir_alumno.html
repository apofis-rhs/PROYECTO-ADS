{% extends 'base.html' %}
{% load static %}

{% block title %}Añadir Alumno{% endblock %}

{% block content %}

<div class="container-fluid mt-4">
  <h1>Añadir (Alta) Alumno</h1>

  <form method="POST" enctype="multipart/form-data">
      {% csrf_token %}

      <div class="caja border rounded p-4">
        
        <div class="caja border rounded p-3 mb-4">
          <h3>Datos Personales</h3>

          <div class="row mt-3">
            <div class="col-4">
              <label class="form-label">Nombre(s) *</label>
              <input type="text" class="form-control" name="nombre" required />
            </div>

            <div class="col-4">
              <label class="form-label">Apellido Paterno *</label>
              <input type="text" class="form-control" name="ape_paterno" required />
            </div>

            <div class="col-4">
              <label class="form-label">Apellido Materno</label>
              <input type="text" class="form-control" name="ape_materno" />
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-4">
                <label class="form-label">Boleta / Matrícula *</label>
                <input type="text" class="form-control" name="boleta" required />
            </div>

            <div class="col-4">
              <label class="form-label">CURP</label>
              <input type="text" class="form-control" name="curp" />
            </div>

            <div class="col-4">
              <label class="form-label">Fecha de nacimiento</label>
              <input type="date" class="form-control" name="fecha_nacimiento" />
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-4">
              <label class="form-label">Sexo</label>
              <select class="form-select" name="sexo">
                <option value="">Seleccionar…</option>
                <option value="F">Femenino</option>
                <option value="M">Masculino</option>
                <option value="O">Otro</option>
              </select>
            </div>

            <div class="col-4">
              <label class="form-label">Nacionalidad</label>
              <input type="text" class="form-control" name="nacionalidad" />
            </div>

            <div class="col-4">
              <label class="form-label">Lugar de nacimiento</label>
              <input type="text" class="form-control" name="lugar_nacimiento" />
            </div>
          </div>
          
          <div class="row mt-3">
            <div class="col-4">
              <label class="form-label">Foto del alumno</label>
              <input type="file" class="form-control" name="foto" />
            </div>
          </div>

        </div>

        <div class="caja border rounded p-3 mb-4">
          <h3>Contactos de Emergencia</h3>
          <p class="text-muted">Puedes agregar uno o varios contactos.</p>

          <div class="row mt-3">
            <div class="col-4">
              <label class="form-label">Nombre completo</label>
              <input type="text" class="form-control" name="contacto_nombre" />
            </div>

            <div class="col-4">
              <label class="form-label">Parentesco</label>
              <input type="text" class="form-control" name="contacto_parentesco" />
            </div>

            <div class="col-4">
              <label class="form-label">Teléfono principal</label>
              <input type="text" class="form-control" name="contacto_telefono" />
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-4">
              <label class="form-label">Teléfono secundario (opcional)</label>
              <input type="text" class="form-control" name="contacto_telefono2" />
            </div>

            <div class="col-8">
              <label class="form-label">Dirección</label>
              <input type="text" class="form-control" name="direccion" />
            </div>
          </div>
        </div>

        <div class="caja border rounded p-3 mb-4">
          <h3>Nivel Educativo y Tutor</h3>

          <div class="row mt-3">
            <div class="col-6">
              <label class="form-label">Nivel *</label>
              <select class="form-select" name="nivel" required>
                <option value="">Seleccionar…</option>
                {% for nivel in niveles %}
                    <option value="{{ nivel.id_nivel }}">{{ nivel.nombre }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="col-6">
              <label class="form-label">Grado / Semestre</label>
              <input type="text" class="form-control" name="grado" />
            </div>
          </div>

          <div class="row mt-3">
             <div class="col-8">
                 <label class="form-label">Tutor Asignado *</label>
                 <select class="form-select" name="tutor" required>
                    <option value="">Seleccione un Tutor existente...</option>
                    {% for tutor in tutores %}
                        <option value="{{ tutor.id_tutor }}">
                            {{ tutor.nombre }} {{ tutor.ape_paterno }} ({{ tutor.curp }})
                        </option>
                    {% endfor %}
                 </select>
             </div>
             
             <div class="col-4 d-flex align-items-end">
                 <a href="{% url 'anadir_tutor' %}" class="btn btnTutor w-100 text-white text-decoration-none">
                    + Nuevo Tutor
                  </a>
             </div>
          </div>

          <p class="text-muted mt-3">
            El tutor es <strong>obligatorio</strong> para guardar el registro.
          </p>

        </div>

        <div class="d-flex justify-content-end mt-4">
          <a href="{% url 'consultar_alumno' %}" class="btn btnCancelar px-4 text-white text-decoration-none">Cancelar</a>
          <button type="submit" class="btn btnGuardarAlumno px-4 ml-4">Guardar Alumno</button>
        </div>
      </div>
  </form>

  <div class="mt-4 d-flex justify-content-center">
    <a href="{% url 'consultar_alumno' %}" class="btn btnRegresar px-3 py-1 text-white text-decoration-none">
      Regresar
    </a>
  </div>
  
  <br><br>
</div>

<script src="{% static 'js/scripts_alumno.js' %}"></script>

{% endblock %}