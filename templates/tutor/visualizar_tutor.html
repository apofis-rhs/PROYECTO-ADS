{% extends 'base.html' %}
{% load static %}

{% block title %}Detalle del Tutor{% endblock %}

{% block content %}

<div class="container-fluid mt-4">
  <div class="caja caja-titulo mb-4">
    <h1>Visualizar Datos del Tutor: {{ tutor.nombre }} {{ tutor.ape_paterno }}</h1>
  </div>

  <div class="caja caja-central d-flex gap-4 mb-4">
    
    <div class="col-4 d-flex flex-column align-items-center p-3 border rounded">
      
      <div class="foto-placeholder mb-3"
           style="width: 200px; height: 200px; border: 2px dashed #999; border-radius: 8px; 
                  overflow: hidden; display: flex; align-items: center; justify-content: center; background-color: #f0f0f0;">
           
           {% if tutor.foto %}
               <img src="{{ tutor.foto.url }}" alt="Foto Tutor" style="width:100%; height:100%; object-fit: cover;">
           {% else %}
               <img src="{% static 'img/tutor_placeholder.png' %}" alt="Sin Foto" style="width:100%; height:100%; object-fit: cover;">
           {% endif %}
      </div>

      <button class="btn btnVisualizar mb-2" style="width: 50%; align-self: center; padding: 6px 0">
        Subir Foto
      </button>

      <button class="btn btnDescargar" style="width: 50%; align-self: center; padding: 6px 0">
        Imprimir Información
      </button>
    </div>

    <div class="col-8 p-3 border rounded">
      
      <div class="mb-3 d-flex justify-content-end">
        <div>
          <label class="form-label fw-bold">Seleccionar hijo:</label>
          
          {% if hijos %}
              <select id="selectHijo" class="form-select" style="width: 250px">
                {% for hijo in hijos %}
                    <option value="{{ hijo.id_alumno }}" 
                            {% if hijo_seleccionado and hijo.id_alumno == hijo_seleccionado.id_alumno %}selected{% endif %}>
                        {{ hijo.boleta }} - {{ hijo.nombre }}
                    </option>
                {% endfor %}
              </select>
          {% else %}
              <span class="text-danger">Este tutor no tiene alumnos asignados.</span>
          {% endif %}
          
        </div>
      </div>

      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Datos del Tutor</th>
            <th>Datos del Hijo Seleccionado</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>Nombre: <strong>{{ tutor.nombre }}</strong></td>
            <td>Nombre del hijo: 
                <strong>{{ hijo_seleccionado.nombre|default:"--" }}</strong>
            </td>
          </tr>

          <tr>
            <td>Apellido paterno: <strong>{{ tutor.ape_paterno }}</strong></td>
            <td>Apellido paterno del hijo: 
                <strong>{{ hijo_seleccionado.ape_paterno|default:"--" }}</strong>
            </td>
          </tr>

          <tr>
            <td>Apellido materno: <strong>{{ tutor.ape_materno|default:"" }}</strong></td>
            <td>Apellido materno del hijo: 
                <strong>{{ hijo_seleccionado.ape_materno|default:"" }}</strong>
            </td>
          </tr>

          <tr>
            <td>CURP: <strong>{{ tutor.curp|default:"N/A" }}</strong></td> 
            <td>Grado educativo: 
                <strong>
                    {% if hijo_seleccionado.nivel %}
                        {{ hijo_seleccionado.nivel.nombre }} {{ hijo_seleccionado.grado }}°
                    {% else %}
                        --
                    {% endif %}
                </strong>
            </td>
          </tr>
          
          <tr>
             <td>Teléfono: <strong>{{ tutor.telefono|default:"N/A" }}</strong></td>
             <td>Boleta: <strong>{{ hijo_seleccionado.boleta|default:"--" }}</strong></td>
          </tr>

        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="mt-4 d-flex justify-content-center">
  <a href="{% url 'consultar_tutor' %}" class="btn btn-secondary px-3 py-1 text-white text-decoration-none" style="font-size: 18px">
    Regresar
  </a>
</div>

{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/scripts_tutor.js' %}"></script>
{% endblock %}